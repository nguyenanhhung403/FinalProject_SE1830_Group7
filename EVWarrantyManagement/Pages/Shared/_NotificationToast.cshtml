@*
    Notification Toast Component
    Displays real-time notifications from SignalR
*@

<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999">
    <div id="notificationToast" class="toast align-items-center border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                <div class="d-flex align-items-center">
                    <i id="toast-icon" class="me-2"></i>
                    <div id="toast-message"></div>
                </div>
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>

<style>
    .toast-info {
        background-color: #0dcaf0;
        color: white;
    }

    .toast-success {
        background-color: #198754;
        color: white;
    }

    .toast-warning {
        background-color: #ffc107;
        color: #000;
    }

    .toast-error {
        background-color: #dc3545;
        color: white;
    }

    .toast-container {
        max-width: 400px;
    }

    .toast {
        min-width: 300px;
    }

    .toast-body {
        padding: 1rem;
        font-size: 0.95rem;
    }

    #toast-icon {
        font-size: 1.2rem;
    }
</style>

<script>
    // Notification Toast Helper
    window.notificationToast = {
        // Show a notification toast
        // Parameters: message (string), type (string), duration (number)
        show: function(message, type = 'info', duration = 5000) {
            const toastEl = document.getElementById('notificationToast');
            const toastBody = toastEl.querySelector('.toast-body');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = document.getElementById('toast-icon');

            // Remove all type classes
            toastEl.classList.remove('toast-info', 'toast-success', 'toast-warning', 'toast-error');

            // Add appropriate type class
            toastEl.classList.add(`toast-${type}`);

            // Set icon based on type
            toastIcon.className = 'me-2 ';
            switch (type) {
                case 'success':
                    toastIcon.classList.add('bi', 'bi-check-circle-fill');
                    break;
                case 'warning':
                    toastIcon.classList.add('bi', 'bi-exclamation-triangle-fill');
                    break;
                case 'error':
                    toastIcon.classList.add('bi', 'bi-x-circle-fill');
                    break;
                case 'info':
                default:
                    toastIcon.classList.add('bi', 'bi-info-circle-fill');
                    break;
            }

            // Set message
            toastMessage.textContent = message;

            // Create and show toast
            const toast = new bootstrap.Toast(toastEl, {
                autohide: true,
                delay: duration
            });

            toast.show();

            // Optional: Play sound for important notifications
            if (type === 'error' || type === 'warning') {
                this.playNotificationSound();
            }
        },

        // Play a subtle notification sound
        playNotificationSound: function() {
            // You can add an audio element or use Web Audio API
            // For now, we'll use a simple beep if available
            try {
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = context.createOscillator();
                const gainNode = context.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(context.destination);

                oscillator.frequency.value = 800;
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.1, context.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.1);

                oscillator.start(context.currentTime);
                oscillator.stop(context.currentTime + 0.1);
            } catch (e) {
                // Silently fail if audio is not supported
            }
        }
    };
</script>
